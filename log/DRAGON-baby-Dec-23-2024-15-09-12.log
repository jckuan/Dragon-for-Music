Mon 23 Dec 2024 15:09:12 INFO ██Server: 	ml-dev1
Mon 23 Dec 2024 15:09:12 INFO ██Dir: 	/home/jordankuan/DRAGON

Mon 23 Dec 2024 15:09:12 INFO 
gpu_id=0
use_gpu=True
seed=[999]
data_path=/nas/MusicRecommendation/data/
inter_splitting_label=x_label
filter_out_cod_start_users=True
is_multimodal_model=True
checkpoint_dir=saved
save_recommended_topk=True
recommend_topk=recommend_topk/
embedding_size=64
epochs=100
stopping_step=20
train_batch_size=2048
learner=adam
learning_rate=[0.0001]
learning_rate_scheduler=[1.0, 50]
eval_step=1
training_neg_sample_num=1
use_neg_sampling=True
use_full_sampling=False
NEG_PREFIX=neg__
USER_ID_FIELD=userID
ITEM_ID_FIELD=itemID
TIME_FIELD=timestamp
field_separator=	
metrics=['Recall', 'NDCG', 'Precision', 'MAP']
topk=[5, 10, 20, 50]
valid_metric=Recall@20
eval_batch_size=4096
use_raw_features=False
max_txt_len=32
max_img_size=256
vocab_size=30522
type_vocab_size=2
hidden_size=4
pad_token_id=0
max_position_embeddings=512
layer_norm_eps=1e-12
hidden_dropout_prob=0.1
end2end=False
hyper_parameters=['mm_image_weight', 'k', 'u_layers', 'n_mm_layers', 'knn_k', 'aggr_mode', 'reg_weight', 'learning_rate', 'seed']
load_meta_cols=['itemID', 'description', 'title', 'category']
TEXT_ID_FIELD=description
inter_file_name=baby14-indexed-v4.inter
text_file_name=meta-games-indexed.csv
img_dir_name=img
vision_feature_file=image_feat.npy
text_feature_file=text_feat-v1.npy
user_graph_dict_file=user_graph_dict.npy
feat_embed_dim=64
n_layers=2
mm_image_weight=[0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]
aggr_mode=['add']
knn_k=[5, 10, 20]
k=[30, 40, 50]
n_mm_layers=[1, 2]
u_layers=[1, 2]
reg_weight=[0.001]
model=DRAGON
dataset=baby
valid_metric_bigger=True
device=cuda


Mon 23 Dec 2024 15:09:12 INFO baby
The number of users: 19445
Average actions of users: 8.269066598097197
The number of items: 7050
Average actions of items: 22.807375886524824
The number of inters: 160792
The sparsity of the dataset: 99.8827082752043%
Mon 23 Dec 2024 15:09:12 INFO 
====Training====
baby
The number of users: 19445
Average actions of users: 6.096734379017742
The number of items: 7047
Average actions of items: 16.82290336313325
The number of inters: 118551
The sparsity of the dataset: 99.9134846831415%
Mon 23 Dec 2024 15:09:12 INFO 
====Validation====
baby
The number of users: 19445
Average actions of users: 1.0572897917202366
The number of items: 5483
Average actions of items: 3.749589640707642
The number of inters: 20559
The sparsity of the dataset: 99.98071694707788%
Mon 23 Dec 2024 15:09:12 INFO 
====Testing====
baby
The number of users: 19445
Average actions of users: 1.1150424273592183
The number of items: 5549
Average actions of items: 3.907370697422959
The number of inters: 21682
The sparsity of the dataset: 99.97990552482683%
Mon 23 Dec 2024 15:09:20 INFO 

=================================


Mon 23 Dec 2024 15:09:20 INFO =========1/324: Parameters:['mm_image_weight', 'k', 'u_layers', 'n_mm_layers', 'knn_k', 'aggr_mode', 'reg_weight', 'learning_rate', 'seed']=(0.1, 30, 1, 1, 5, 'add', 0.001, 0.0001, 999)=======
Mon 23 Dec 2024 15:09:22 INFO DRAGON(
  (MLP_v): Linear(in_features=64, out_features=64, bias=False)
  (MLP_t): Linear(in_features=64, out_features=64, bias=False)
  (image_embedding): Embedding(7050, 4096)
  (image_trs): Linear(in_features=4096, out_features=64, bias=True)
  (text_embedding): Embedding(7050, 384)
  (text_trs): Linear(in_features=384, out_features=64, bias=True)
  (MLP_user): Linear(in_features=128, out_features=64, bias=True)
  (v_gcn): GCN(
    (MLP): Linear(in_features=4096, out_features=256, bias=True)
    (MLP_1): Linear(in_features=256, out_features=64, bias=True)
    (conv_embed_1): Base_gcn(64, 64)
  )
  (t_gcn): GCN(
    (MLP): Linear(in_features=384, out_features=256, bias=True)
    (MLP_1): Linear(in_features=256, out_features=64, bias=True)
    (conv_embed_1): Base_gcn(64, 64)
  )
  (user_graph): User_Graph_sample()
)
Trainable parameters: 35609534
Mon 23 Dec 2024 15:09:28 INFO epoch 0 training [time: 5.61s, train loss: 33.9129]
Mon 23 Dec 2024 15:09:34 INFO epoch 0 evaluating [time: 2.81s, valid_score: 0.055900]
Mon 23 Dec 2024 15:09:34 INFO valid result: 
recall@5: 0.0214    recall@10: 0.0347    recall@20: 0.0559    recall@50: 0.1035    ndcg@5: 0.0144    ndcg@10: 0.0187    ndcg@20: 0.0241    ndcg@50: 0.0335    precision@5: 0.0045    precision@10: 0.0036    precision@20: 0.0029    precision@50: 0.0022    map@5: 0.0119    map@10: 0.0136    map@20: 0.0151    map@50: 0.0165    
Mon 23 Dec 2024 15:09:34 INFO test result: 
recall@5: 0.0222    recall@10: 0.0364    recall@20: 0.0576    recall@50: 0.1060    ndcg@5: 0.0150    ndcg@10: 0.0197    ndcg@20: 0.0251    ndcg@50: 0.0348    precision@5: 0.0049    precision@10: 0.0040    precision@20: 0.0032    precision@50: 0.0024    map@5: 0.0122    map@10: 0.0141    map@20: 0.0156    map@50: 0.0171    
Mon 23 Dec 2024 15:09:34 INFO ██ DRAGON--Best validation results updated!!!
Mon 23 Dec 2024 15:09:37 INFO epoch 1 training [time: 3.61s, train loss: 26.9901]
Mon 23 Dec 2024 15:09:43 INFO epoch 1 evaluating [time: 2.79s, valid_score: 0.068700]
Mon 23 Dec 2024 15:09:43 INFO valid result: 
recall@5: 0.0271    recall@10: 0.0426    recall@20: 0.0687    recall@50: 0.1262    ndcg@5: 0.0177    ndcg@10: 0.0227    ndcg@20: 0.0293    ndcg@50: 0.0408    precision@5: 0.0056    precision@10: 0.0044    precision@20: 0.0036    precision@50: 0.0027    map@5: 0.0145    map@10: 0.0165    map@20: 0.0183    map@50: 0.0201    
Mon 23 Dec 2024 15:09:43 INFO test result: 
recall@5: 0.0299    recall@10: 0.0443    recall@20: 0.0702    recall@50: 0.1263    ndcg@5: 0.0196    ndcg@10: 0.0244    ndcg@20: 0.0310    ndcg@50: 0.0423    precision@5: 0.0065    precision@10: 0.0049    precision@20: 0.0039    precision@50: 0.0028    map@5: 0.0158    map@10: 0.0177    map@20: 0.0195    map@50: 0.0212    
Mon 23 Dec 2024 15:09:43 INFO ██ DRAGON--Best validation results updated!!!
Mon 23 Dec 2024 15:09:47 INFO epoch 2 training [time: 3.54s, train loss: 22.0799]
Mon 23 Dec 2024 15:09:52 INFO epoch 2 evaluating [time: 2.87s, valid_score: 0.077000]
Mon 23 Dec 2024 15:09:52 INFO valid result: 
recall@5: 0.0294    recall@10: 0.0473    recall@20: 0.0770    recall@50: 0.1359    ndcg@5: 0.0193    ndcg@10: 0.0251    ndcg@20: 0.0327    ndcg@50: 0.0444    precision@5: 0.0061    precision@10: 0.0050    precision@20: 0.0040    precision@50: 0.0029    map@5: 0.0158    map@10: 0.0181    map@20: 0.0202    map@50: 0.0220    
Mon 23 Dec 2024 15:09:52 INFO test result: 
recall@5: 0.0313    recall@10: 0.0497    recall@20: 0.0766    recall@50: 0.1382    ndcg@5: 0.0206    ndcg@10: 0.0266    ndcg@20: 0.0335    ndcg@50: 0.0459    precision@5: 0.0069    precision@10: 0.0055    precision@20: 0.0042    precision@50: 0.0031    map@5: 0.0166    map@10: 0.0190    map@20: 0.0208    map@50: 0.0227    
Mon 23 Dec 2024 15:09:52 INFO ██ DRAGON--Best validation results updated!!!
Mon 23 Dec 2024 15:09:56 INFO epoch 3 training [time: 3.53s, train loss: 18.8739]
Mon 23 Dec 2024 15:10:02 INFO epoch 3 evaluating [time: 2.84s, valid_score: 0.079800]
Mon 23 Dec 2024 15:10:02 INFO valid result: 
recall@5: 0.0310    recall@10: 0.0503    recall@20: 0.0798    recall@50: 0.1428    ndcg@5: 0.0203    ndcg@10: 0.0266    ndcg@20: 0.0341    ndcg@50: 0.0467    precision@5: 0.0065    precision@10: 0.0053    precision@20: 0.0042    precision@50: 0.0030    map@5: 0.0166    map@10: 0.0191    map@20: 0.0212    map@50: 0.0231    
Mon 23 Dec 2024 15:10:02 INFO test result: 
recall@5: 0.0333    recall@10: 0.0516    recall@20: 0.0805    recall@50: 0.1450    ndcg@5: 0.0219    ndcg@10: 0.0279    ndcg@20: 0.0353    ndcg@50: 0.0484    precision@5: 0.0074    precision@10: 0.0057    precision@20: 0.0045    precision@50: 0.0032    map@5: 0.0176    map@10: 0.0200    map@20: 0.0220    map@50: 0.0240    
Mon 23 Dec 2024 15:10:02 INFO ██ DRAGON--Best validation results updated!!!
Mon 23 Dec 2024 15:10:05 INFO epoch 4 training [time: 3.55s, train loss: 16.5951]
Mon 23 Dec 2024 15:10:11 INFO epoch 4 evaluating [time: 2.89s, valid_score: 0.083300]
Mon 23 Dec 2024 15:10:11 INFO valid result: 
recall@5: 0.0316    recall@10: 0.0528    recall@20: 0.0833    recall@50: 0.1467    ndcg@5: 0.0208    ndcg@10: 0.0277    ndcg@20: 0.0354    ndcg@50: 0.0481    precision@5: 0.0066    precision@10: 0.0055    precision@20: 0.0044    precision@50: 0.0031    map@5: 0.0170    map@10: 0.0198    map@20: 0.0219    map@50: 0.0239    
Mon 23 Dec 2024 15:10:11 INFO test result: 
recall@5: 0.0333    recall@10: 0.0528    recall@20: 0.0835    recall@50: 0.1506    ndcg@5: 0.0220    ndcg@10: 0.0284    ndcg@20: 0.0363    ndcg@50: 0.0498    precision@5: 0.0073    precision@10: 0.0058    precision@20: 0.0046    precision@50: 0.0033    map@5: 0.0177    map@10: 0.0203    map@20: 0.0224    map@50: 0.0245    
Mon 23 Dec 2024 15:10:11 INFO ██ DRAGON--Best validation results updated!!!
Mon 23 Dec 2024 15:10:14 INFO epoch 5 training [time: 3.54s, train loss: 14.7328]
Mon 23 Dec 2024 15:10:20 INFO epoch 5 evaluating [time: 2.79s, valid_score: 0.084600]
Mon 23 Dec 2024 15:10:20 INFO valid result: 
recall@5: 0.0340    recall@10: 0.0528    recall@20: 0.0846    recall@50: 0.1490    ndcg@5: 0.0221    ndcg@10: 0.0282    ndcg@20: 0.0362    ndcg@50: 0.0491    precision@5: 0.0071    precision@10: 0.0055    precision@20: 0.0045    precision@50: 0.0031    map@5: 0.0179    map@10: 0.0204    map@20: 0.0225    map@50: 0.0245    
Mon 23 Dec 2024 15:10:20 INFO test result: 
recall@5: 0.0341    recall@10: 0.0545    recall@20: 0.0864    recall@50: 0.1524    ndcg@5: 0.0224    ndcg@10: 0.0290    ndcg@20: 0.0372    ndcg@50: 0.0506    precision@5: 0.0075    precision@10: 0.0060    precision@20: 0.0048    precision@50: 0.0034    map@5: 0.0179    map@10: 0.0206    map@20: 0.0228    map@50: 0.0249    
Mon 23 Dec 2024 15:10:20 INFO ██ DRAGON--Best validation results updated!!!
Mon 23 Dec 2024 15:10:24 INFO epoch 6 training [time: 3.62s, train loss: 13.2400]
Mon 23 Dec 2024 15:10:29 INFO epoch 6 evaluating [time: 2.80s, valid_score: 0.087100]
Mon 23 Dec 2024 15:10:29 INFO valid result: 
recall@5: 0.0343    recall@10: 0.0549    recall@20: 0.0871    recall@50: 0.1521    ndcg@5: 0.0227    ndcg@10: 0.0293    ndcg@20: 0.0375    ndcg@50: 0.0504    precision@5: 0.0072    precision@10: 0.0058    precision@20: 0.0046    precision@50: 0.0032    map@5: 0.0186    map@10: 0.0213    map@20: 0.0234    map@50: 0.0255    
Mon 23 Dec 2024 15:10:29 INFO test result: 
recall@5: 0.0348    recall@10: 0.0558    recall@20: 0.0883    recall@50: 0.1565    ndcg@5: 0.0232    ndcg@10: 0.0301    ndcg@20: 0.0385    ndcg@50: 0.0522    precision@5: 0.0077    precision@10: 0.0062    precision@20: 0.0049    precision@50: 0.0035    map@5: 0.0188    map@10: 0.0216    map@20: 0.0238    map@50: 0.0260    
Mon 23 Dec 2024 15:10:29 INFO ██ DRAGON--Best validation results updated!!!
Mon 23 Dec 2024 15:10:33 INFO epoch 7 training [time: 3.52s, train loss: 12.2235]
Mon 23 Dec 2024 15:10:38 INFO epoch 7 evaluating [time: 2.80s, valid_score: 0.087900]
Mon 23 Dec 2024 15:10:38 INFO valid result: 
recall@5: 0.0334    recall@10: 0.0557    recall@20: 0.0879    recall@50: 0.1551    ndcg@5: 0.0223    ndcg@10: 0.0295    ndcg@20: 0.0377    ndcg@50: 0.0511    precision@5: 0.0070    precision@10: 0.0058    precision@20: 0.0046    precision@50: 0.0033    map@5: 0.0183    map@10: 0.0213    map@20: 0.0235    map@50: 0.0256    
Mon 23 Dec 2024 15:10:38 INFO test result: 
recall@5: 0.0353    recall@10: 0.0571    recall@20: 0.0894    recall@50: 0.1566    ndcg@5: 0.0233    ndcg@10: 0.0304    ndcg@20: 0.0388    ndcg@50: 0.0523    precision@5: 0.0078    precision@10: 0.0063    precision@20: 0.0050    precision@50: 0.0035    map@5: 0.0188    map@10: 0.0216    map@20: 0.0239    map@50: 0.0260    
Mon 23 Dec 2024 15:10:38 INFO ██ DRAGON--Best validation results updated!!!
Mon 23 Dec 2024 15:10:42 INFO epoch 8 training [time: 3.51s, train loss: 11.1610]
Mon 23 Dec 2024 15:10:47 INFO epoch 8 evaluating [time: 2.80s, valid_score: 0.089800]
Mon 23 Dec 2024 15:10:47 INFO valid result: 
recall@5: 0.0347    recall@10: 0.0559    recall@20: 0.0898    recall@50: 0.1554    ndcg@5: 0.0226    ndcg@10: 0.0295    ndcg@20: 0.0381    ndcg@50: 0.0512    precision@5: 0.0073    precision@10: 0.0059    precision@20: 0.0047    precision@50: 0.0033    map@5: 0.0184    map@10: 0.0212    map@20: 0.0235    map@50: 0.0255    
Mon 23 Dec 2024 15:10:47 INFO test result: 
recall@5: 0.0353    recall@10: 0.0568    recall@20: 0.0921    recall@50: 0.1601    ndcg@5: 0.0234    ndcg@10: 0.0304    ndcg@20: 0.0395    ndcg@50: 0.0532    precision@5: 0.0078    precision@10: 0.0063    precision@20: 0.0051    precision@50: 0.0036    map@5: 0.0189    map@10: 0.0217    map@20: 0.0241    map@50: 0.0263    
Mon 23 Dec 2024 15:10:47 INFO ██ DRAGON--Best validation results updated!!!
Mon 23 Dec 2024 15:10:51 INFO epoch 9 training [time: 3.50s, train loss: 10.2837]
Mon 23 Dec 2024 15:10:57 INFO epoch 9 evaluating [time: 2.92s, valid_score: 0.090300]
Mon 23 Dec 2024 15:10:57 INFO valid result: 
recall@5: 0.0360    recall@10: 0.0572    recall@20: 0.0903    recall@50: 0.1556    ndcg@5: 0.0234    ndcg@10: 0.0303    ndcg@20: 0.0387    ndcg@50: 0.0517    precision@5: 0.0075    precision@10: 0.0060    precision@20: 0.0047    precision@50: 0.0033    map@5: 0.0190    map@10: 0.0218    map@20: 0.0240    map@50: 0.0261    
Mon 23 Dec 2024 15:10:57 INFO test result: 
recall@5: 0.0360    recall@10: 0.0572    recall@20: 0.0918    recall@50: 0.1598    ndcg@5: 0.0238    ndcg@10: 0.0307    ndcg@20: 0.0396    ndcg@50: 0.0533    precision@5: 0.0079    precision@10: 0.0063    precision@20: 0.0051    precision@50: 0.0036    map@5: 0.0191    map@10: 0.0219    map@20: 0.0243    map@50: 0.0265    
Mon 23 Dec 2024 15:10:57 INFO ██ DRAGON--Best validation results updated!!!
Mon 23 Dec 2024 15:11:00 INFO epoch 10 training [time: 3.51s, train loss: 9.5480]
Mon 23 Dec 2024 15:11:06 INFO epoch 10 evaluating [time: 2.80s, valid_score: 0.092300]
Mon 23 Dec 2024 15:11:06 INFO valid result: 
recall@5: 0.0362    recall@10: 0.0584    recall@20: 0.0923    recall@50: 0.1581    ndcg@5: 0.0237    ndcg@10: 0.0309    ndcg@20: 0.0394    ndcg@50: 0.0526    precision@5: 0.0075    precision@10: 0.0061    precision@20: 0.0049    precision@50: 0.0033    map@5: 0.0193    map@10: 0.0222    map@20: 0.0245    map@50: 0.0265    
Mon 23 Dec 2024 15:11:06 INFO test result: 
recall@5: 0.0365    recall@10: 0.0581    recall@20: 0.0936    recall@50: 0.1608    ndcg@5: 0.0244    ndcg@10: 0.0314    ndcg@20: 0.0405    ndcg@50: 0.0541    precision@5: 0.0081    precision@10: 0.0064    precision@20: 0.0052    precision@50: 0.0036    map@5: 0.0198    map@10: 0.0226    map@20: 0.0250    map@50: 0.0272    
Mon 23 Dec 2024 15:11:06 INFO ██ DRAGON--Best validation results updated!!!
Mon 23 Dec 2024 15:11:09 INFO epoch 11 training [time: 3.61s, train loss: 8.8707]
